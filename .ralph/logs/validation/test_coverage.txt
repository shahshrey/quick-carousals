$ vitest run --run --coverage

 RUN  v4.0.18 /Users/shrey/Downloads/quick-carousals/apps/nextjs
      Coverage enabled with v8

 ✓ src/lib/render-slide.test.ts (5 tests) 39ms
 ✓ src/lib/text-measure.test.ts (11 tests) 29ms
 ✓ src/lib/generate-pdf.test.ts (6 tests) 37ms
stderr | src/hooks/use-auto-save.test.ts > useAutoSave > Save Status Indicator > should show error state on save failure
Auto-save error: Error: Save failed
    at performSave (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/hooks/use-auto-save.ts:78:17)

stderr | src/hooks/use-auto-save.test.ts > useAutoSave > Save Status Indicator > should handle network errors gracefully
Auto-save error: Error: Network error
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/hooks/use-auto-save.test.ts:191:51
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:12)

 ✓ src/hooks/use-auto-save.test.ts (9 tests) 26ms
stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > returns 400 for empty request body
API Error: ApiError: Invalid request body
    at Object.validation (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:51:5)
    at validateBody (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/validations/api.ts:21:23)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:86:18
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:82:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'VALIDATION_ERROR',
  statusCode: 400,
  details: { issues: [ [Object] ] }
}

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > returns 400 for missing topic field
API Error: ApiError: Invalid request body
    at Object.validation (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:51:5)
    at validateBody (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/validations/api.ts:21:23)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:86:18
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:97:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'VALIDATION_ERROR',
  statusCode: 400,
  details: { issues: [ [Object] ] }
}

stderr | src/app/api/generate/text/route.test.ts > POST /api/generate/text > returns 400 when text is missing
API Error: ApiError: Invalid request body
    at Object.validation (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:51:5)
    at validateBody (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/validations/api.ts:21:23)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.ts:196:18
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.test.ts:70:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'VALIDATION_ERROR',
  statusCode: 400,
  details: { issues: [ [Object] ] }
}

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > returns 400 for invalid slideCount (too low)
API Error: ApiError: Invalid request body
    at Object.validation (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:51:5)
    at validateBody (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/validations/api.ts:21:23)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:86:18
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:112:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'VALIDATION_ERROR',
  statusCode: 400,
  details: { issues: [ [Object] ] }
}

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > returns 400 for invalid slideCount (too high)
API Error: ApiError: Invalid request body
    at Object.validation (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:51:5)
    at validateBody (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/validations/api.ts:21:23)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:86:18
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:127:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'VALIDATION_ERROR',
  statusCode: 400,
  details: { issues: [ [Object] ] }
}

stderr | src/app/api/generate/text/route.test.ts > POST /api/generate/text > returns 400 when text is too short
API Error: ApiError: Invalid request body
    at Object.validation (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:51:5)
    at validateBody (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/validations/api.ts:21:23)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.ts:196:18
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.test.ts:85:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'VALIDATION_ERROR',
  statusCode: 400,
  details: { issues: [ [Object] ] }
}

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > returns 400 for invalid tone
API Error: ApiError: Invalid request body
    at Object.validation (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:51:5)
    at validateBody (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/validations/api.ts:21:23)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:86:18
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:142:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'VALIDATION_ERROR',
  statusCode: 400,
  details: { issues: [ [Object] ] }
}

stderr | src/app/api/generate/text/route.test.ts > POST /api/generate/text > returns 400 when text is too long
API Error: ApiError: Invalid request body
    at Object.validation (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:51:5)
    at validateBody (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/validations/api.ts:21:23)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.ts:196:18
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.test.ts:102:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'VALIDATION_ERROR',
  statusCode: 400,
  details: { issues: [ [Object] ] }
}

stderr | src/app/api/generate/text/route.test.ts > POST /api/generate/text > handles AI generation errors
OpenAI generation error: Error: OpenAI API error
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.test.ts:203:45
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:12)

stderr | src/app/api/generate/text/route.test.ts > POST /api/generate/text > handles AI generation errors
API Error: ApiError: Failed to generate carousel from text. Please try again with clearer content.
    at Object.internal (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:86:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.ts:316:25
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.test.ts:213:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'INTERNAL_ERROR',
  statusCode: 500,
  details: undefined
}

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > handles OpenAI timeout gracefully
OpenAI generation error: Error: Request timeout
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:267:45
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:12)

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > handles OpenAI timeout gracefully
API Error: ApiError: AI generation timed out. Please try again.
    at Object.internal (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:86:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:197:27
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:276:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'INTERNAL_ERROR',
  statusCode: 500,
  details: undefined
}

stderr | src/app/api/generate/text/route.test.ts > POST /api/generate/text > handles rate limit errors
OpenAI generation error: Error: Rate limit exceeded
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.test.ts:220:45
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:12)

stderr | src/app/api/generate/text/route.test.ts > POST /api/generate/text > handles rate limit errors
API Error: ApiError: Too many requests. Please try again in 60 seconds.
    at Object.rateLimited (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:75:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.ts:312:27
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/text/route.test.ts:230:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'RATE_LIMITED',
  statusCode: 429,
  details: { retryAfter: 60 }
}

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > handles OpenAI rate limit error
OpenAI generation error: Error: Rate limit exceeded
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:285:45
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:12)

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > handles OpenAI rate limit error
API Error: ApiError: Too many requests. Please try again in 60 seconds.
    at Object.rateLimited (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:75:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:201:27
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:294:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'RATE_LIMITED',
  statusCode: 429,
  details: { retryAfter: 60 }
}

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > handles generic OpenAI failure
OpenAI generation error: Error: OpenAI service error
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:302:45
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///Users/shrey/Downloads/quick-carousals/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:1653:12)

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > handles generic OpenAI failure
API Error: ApiError: Failed to generate carousel. Please try again with a clearer topic.
    at Object.internal (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:86:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:205:25
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:311:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'INTERNAL_ERROR',
  statusCode: 500,
  details: undefined
}

stderr | src/app/api/generate/topic/route.test.ts > POST /api/generate/topic > handles empty slide plan from AI
API Error: ApiError: AI generated empty slide plan
    at Object.internal (/Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/api-error.ts:86:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.ts:121:25
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:54:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/lib/with-auth.ts:33:14
    at /Users/shrey/Downloads/quick-carousals/apps/nextjs/src/app/api/generate/topic/route.test.ts:328:22
    at file:///Users/shrey/Downloads/quick-carousals/node_modules/@vitest/runner/dist/index.js:915:20 {
  code: 'INTERNAL_ERROR',
  statusCode: 500,
  details: undefined
}

 ✓ src/app/api/generate/text/route.test.ts (9 tests) 144ms
 ✓ src/app/api/generate/topic/route.test.ts (12 tests) 147ms
 ✓ src/app/api/projects/route.test.ts (7 tests) 281ms
 ✓ src/lib/openai.test.ts (48 tests) 7450ms
       ✓ should retry on transient errors (500)  3006ms
       ✓ should retry on timeout errors  1108ms
       ✓ should throw after max retries exceeded  3003ms

 Test Files  8 passed (8)
      Tests  107 passed (107)
   Start at  16:51:35
   Duration  8.14s (transform 578ms, setup 0ms, import 666ms, tests 8.15s, environment 3.06s)

 % Coverage report from v8
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |   70.26 |       60 |    77.9 |   70.98 |                   
 .../generate/text |   68.96 |    43.85 |     100 |   68.96 |                   
  route.ts         |   68.96 |    43.85 |     100 |   68.96 | ...74,299,308,322 
 ...generate/topic |   81.57 |    55.55 |     100 |   81.57 |                   
  route.ts         |   81.57 |    55.55 |     100 |   81.57 | ...29,156,169,211 
 app/api/projects  |    12.5 |        0 |       0 |   13.33 |                   
  route.ts         |    12.5 |        0 |       0 |   13.33 | 39-71,84-143      
 .../projects/[id] |    8.19 |        0 |       0 |    9.25 |                   
  route.ts         |    8.19 |        0 |       0 |    9.25 | ...89-143,152-184 
 hooks             |   97.22 |       90 |   85.71 |     100 |                   
  use-auto-save.ts |   97.22 |       90 |   85.71 |     100 | 78-87             
 lib               |   86.53 |    77.22 |   89.83 |   86.39 |                   
  api-error.ts     |   52.38 |       40 |      60 |   52.38 | 63-69,95-109      
  generate-pdf.ts  |   84.61 |       40 |   83.33 |   83.33 | 84-89             
  openai.ts        |      97 |    89.85 |     100 |   96.87 | 210,574-575       
  render-slide.ts  |   79.48 |    72.05 |      90 |   79.46 | ...72-275,280-283 
  text-measure.ts  |   97.05 |    88.88 |     100 |   97.05 | 31,39             
  with-auth.ts     |   76.47 |       50 |     100 |   76.47 | 35-40,74          
 lib/validations   |   21.42 |    11.11 |   22.22 |   21.42 |                   
  api.ts           |   21.42 |    11.11 |   22.22 |   21.42 | 29-109            
-------------------|---------|----------|---------|---------|-------------------
